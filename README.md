# PCS(ProcessesCommunicationSystem)
A DDS(Data Distribution Service) implementation

## 一、简介
### 1. 目的
本系统旨在开发一种可运行在linux操作系统环境下，能够部分替代ROS1的库，其本质是一种能够实现分布式的、多个进程间组网的、通信的方法的库。本系统部分采用了DDS(Data Distribution Service)标准，实现了以数据为中心的发布/订阅(Data-CentricPublish-Subscribe)机制，DDS将分布式网络中传输的数据定义为主题(Topic),将数据的产生对象定义为发布者(Publisher),数据的接收对象定义为订阅者(Subscriber),两者执行的动作即发布(Publish)和订阅(Subscribe)，并将每一个进程实体称之为节点(Node)。使用订阅/发布机制可有效实现分布式的多进程通信中的数据解耦合,即节点间数据的发布和订阅是分开的，互不关系对方是否存在，只需通过主题(topic)来进行关联即可。此外，本系统在UDP协议基础上实现了一个节点间发现协议,可实现分布式网络中的节点间的自组网工作，包括网络节点的增添和删除管理，可实现一对一，一对多和多对多的进程间通信方式，并且只需要使用简单的几个接口函数即可实现。
### 2. 特点
#### a. 取消了Master节点
ROS1最大的一个特征之一是在系统开始工作之前要使用roscore命令启动一个Master节点，此节点即节点管理器，其功能主要有四个：为ROS节点提供命名和注册服务；帮助ROS节点间进行相互的查找；相同topic的节点间通信的建立以及提供一个参数服务器帮助ROS管理全局参数。故每一个节点的接入，删除，topic的维护都是通过Master节点来完成的。因此ROS1中Master节点的重要性高于一般的节点，一旦Master节点由于意外或者各种因素而退出，整个网络将彻底崩溃，不能工作。<br>
本系统针对这个问题采用了一个自定义的节点间发现协议(Nodes Discovery Protocol)来消除掉Master节点，即在此PCS网络中每一个节点都是平等的，任何节点的接入或者删除都不会影响到其他的节点的正常工作，通过topic进行匹配和建立通信链接的过程都是节点自己完成的，不需要再像ROS1中需要借助于Master节点。此方法的实现要点是在每一个节点中都维护一张主题信息表(Topic Information Table)，每当有节点的删除或接入就在整个PCS网络中对每一个节点的表都进行更新，确保所有节点所掌握的网络信息都是一样的。
#### b. 高实时性
本系统未使用任何第三方库，避免了封装带来的效率问题，通过直接调用linux操作系统的系统接口来实现所有的操作。进程间的通信主要是通过面向连接的TCP协议和共享内存来实现。在主机与主机之间的不同进程间使用TCP协议来进行通信，而在主机内部的进程间通信则采用共享内存来实现，这样通信的时延大小也主要取决消息在于信道间传输所花费的时间的大小，而tcp协议中解包或者共享内存的一些内存读写操作所消耗的时间影响极小，可满足绝大多数的任务需求。
#### c. 实现了两种消息时间戳同步的方法
在分布式应用或者多进程间通信过程中，消息同步是一件很重要的事情，本系统采用了两种消息同步的策略。第一种是最近时间戳(Approximate TimeStamp Synchronization)同步方法和插值同步(Interpolation Synchronization)方法。其原理可在后续详解。

待续。。。。。
